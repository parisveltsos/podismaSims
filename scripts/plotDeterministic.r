library(plotrix)
datapath <- '~/git/podismaSims/output/SIMNAME'
fdata <- read.table(file.path(datapath, 'Rinput_Repl0DetChrCline.txt'), header=T)
ffdata <- read.table(file.path(datapath, 'Rinput_Repl0DetFemaleChrCline.txt'), header=T)
fmdata <- read.table(file.path(datapath, 'Rinput_Repl0DetMaleChrCline.txt'), header=T)
ydata <- read.table(file.path(datapath, 'Rinput_Repl0DetTotalY.txt'), header=T)
yfdata <- read.table(file.path(datapath, 'Rinput_Repl0DetYinFemales.txt'), header=T)

ffitness <- read.table(file.path(datapath, 'Rinput_Repl0DetFemaleFitness.txt'), header=T)
mfitness <- read.table(file.path(datapath, 'Rinput_Repl0DetMaleFitness.txt'), header=T)
afitness <- read.table(file.path(datapath, 'Rinput_Repl0DetAllFitness.txt'), header=T)

m1data <- read.table(file.path(datapath, 'Rinput_Repl0DetM1.txt'), header=T)
m2data <- read.table(file.path(datapath, 'Rinput_Repl0DetM2.txt'), header=T)
m3data <- read.table(file.path(datapath, 'Rinput_Repl0DetM3.txt'), header=T)
m4data <- read.table(file.path(datapath, 'Rinput_Repl0DetM4.txt'), header=T)
m5data <- read.table(file.path(datapath, 'Rinput_Repl0DetM5.txt'), header=T)

f1data <- read.table(file.path(datapath, 'Rinput_Repl0DetF1.txt'), header=T)
f2data <- read.table(file.path(datapath, 'Rinput_Repl0DetF2.txt'), header=T)
f3data <- read.table(file.path(datapath, 'Rinput_Repl0DetF3.txt'), header=T)
f4data <- read.table(file.path(datapath, 'Rinput_Repl0DetF4.txt'), header=T)
f5data <- read.table(file.path(datapath, 'Rinput_Repl0DetF5.txt'), header=T)
f6data <- read.table(file.path(datapath, 'Rinput_Repl0DetF6.txt'), header=T)

tabData <- read.table(file.path(datapath, 'table.txt'))


pdf(file.path(datapath,'clinePlotDet.pdf'), width=12, height=12)
par(mfrow=c(3,2)) 
par(mar=c(5,5,4,3))
plot(seq(1:40), fdata$X1, type='n', xlab="HZ location", ylab="% cline", main="Fusion cline", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), fdata$X1, lw=2)
lines(seq(1:40), fdata$X10, col=2, lw=2)
lines(seq(1:40), fdata$X20, col=3, lw=2)
lines(seq(1:40), fdata$X30, col=4, lw=2)
lines(seq(1:40), fdata$X40, col=6, lw=2)
lines(seq(1:40), fdata$X100, col=8, lw=2)
legend('bottomright', inset=0.02, legend=c('g1', 'g100', 'g200', 'g300', 'g400', 'g1000'), pch =c(20), col=c(1,2,3,4,6,8), cex=0.8 )

par(mar=c(5,5,4,3))
plot(seq(1:40), ffdata$X1, type='n', xlab="HZ location", ylab="% cline", main="Fusion cline females", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), ffdata$X1, lw=2)
lines(seq(1:40), ffdata$X10, col=2, lw=2)
lines(seq(1:40), ffdata$X20, col=3, lw=2)
lines(seq(1:40), ffdata$X30, col=4, lw=2)
lines(seq(1:40), ffdata$X40, col=6, lw=2)
lines(seq(1:40), ffdata$X100, col=8, lw=2)

par(mar=c(5,5,4,3))
plot(seq(1:40), ydata$X1, type='n', xlab="HZ location", ylab="% cline", main="Y cline", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), ydata$X1, lty=2, lw=2)
lines(seq(1:40), ydata$X10, col=2, lty=2, lw=2)
lines(seq(1:40), ydata$X20, col=3, lty=2, lw=2)
lines(seq(1:40), ydata$X30, col=4, lty=2, lw=2)
lines(seq(1:40), ydata$X40, col=6, lty=2, lw=2)
lines(seq(1:40), ydata$X100, col=8, lty=2, lw=2)

par(mar=c(5,5,4,3))
plot(c(0,40), c(0,1), type='n', xlab="HZ location", ylab="% cline", main="Y females cline", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), yfdata$X1, lty=2, lw=2)
lines(seq(1:40), yfdata$X10, col=2, lty=2, lw=2)
lines(seq(1:40), yfdata$X20, col=3, lty=2, lw=2)
lines(seq(1:40), yfdata$X30, col=4, lty=2, lw=2)
lines(seq(1:40), yfdata$X40, col=6, lty=2, lw=2)
lines(seq(1:40), yfdata$X100, col=8, lty=2, lw=2)

par(mar=c(5,5,4,3))
plot(seq(1:40), fmdata$X1, type='n', xlab="HZ location", ylab="% cline", main="Fusion cline males", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), fmdata$X1, lw=2)
lines(seq(1:40), fmdata$X10, col=2, lw=2)
lines(seq(1:40), fmdata$X20, col=3, lw=2)
lines(seq(1:40), fmdata$X30, col=4, lw=2)
lines(seq(1:40), fmdata$X40, col=6, lw=2)
lines(seq(1:40), fmdata$X100, col=8, lw=2)

plot(0, type="n", axes=F, xlab="", ylab="", main="Sim parameters (Deterministic)")
addtable2plot(.6, -0.5, tabData, bty='o', hlines=F, vlines=F, display.rownames=F, display.colnames=F, yjust=1, xjust=0, cex=0.9)
dev.off()

pdf(file.path(datapath,'fitnessPlotDet.pdf'), width=12, height=12)
par(mfrow=c(3,2)) 
par(mar=c(5,5,4,3))
plot(c(0,40), c(min(ffitness$X30, mfitness$X30)-0.1,1), type='n', xlab="HZ location", ylab="Female fitness", main="F fitness", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), ffitness$X1, lty=3, lw=2)
lines(seq(1:40), ffitness$X10, col=2, lty=3, lw=2)
lines(seq(1:40), ffitness$X20, col=3, lty=3, lw=2)
lines(seq(1:40), ffitness$X30, col=4, lty=3, lw=2)
lines(seq(1:40), ffitness$X40, col=6, lty=3, lw=2)
lines(seq(1:40), ffitness$X100, col=8, lty=3, lw=2)
legend('bottomright', inset=0.02, legend=c('g1', 'g100', 'g200', 'g300', 'g400', 'g1000'), pch =c(20), col=c(1,2,3,4,6,8), cex=0.8 )

par(mar=c(5,5,4,3))
plot(c(0,40), c(min(ffitness$X30, mfitness$X30)-0.1,1), type='n', xlab="HZ location", ylab="Male fitness", main="M fitness", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), mfitness$X1, lty=1, lw=2)
lines(seq(1:40), mfitness$X10, col=2, lty=1, lw=2)
lines(seq(1:40), mfitness$X20, col=3, lty=1, lw=2)
lines(seq(1:40), mfitness$X30, col=4, lty=1, lw=2)
lines(seq(1:40), mfitness$X40, col=6, lty=1, lw=2)
lines(seq(1:40), mfitness$X100, col=8, lty=1, lw=2)

par(mar=c(5,5,4,3))
plot(c(0,40), c(min(ffitness$X30, mfitness$X30)-0.1,1), type='n', xlab="HZ location", ylab="Total fitness", main="All fitness", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), afitness$X1, lty=2, lw=2)
lines(seq(1:40), afitness$X10, col=2, lty=2, lw=2)
lines(seq(1:40), afitness$X20, col=3, lty=2, lw=2)
lines(seq(1:40), afitness$X30, col=4, lty=2, lw=2)
lines(seq(1:40), afitness$X40, col=6, lty=2, lw=2)
lines(seq(1:40), afitness$X100, col=8, lty=2, lw=2)

plot(0, type="n", axes=F, xlab="", ylab="", main="Sim parameters (Deterministic)")
addtable2plot(.6, -0.5, tabData, bty='o', hlines=F, vlines=F, display.rownames=F, display.colnames=F, yjust=1, xjust=0, cex=0.9)
dev.off()


pdf(file.path(datapath,'karyotypeSig.pdf'), width=12, height=12)
par(mfrow=c(3,2)) 
par(mar=c(5,5,4,3))
plot(seq(1:40), m1data$X10, type='n', xlab="HZ location", ylab="% cline", main="Male genotype cline 1000 gen", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), m1data$X10, lw=2)
lines(seq(1:40), m2data$X10, col=2, lw=2)
lines(seq(1:40), m3data$X10, col=3, lw=2)
lines(seq(1:40), m4data$X10, col=4, lw=2)
lines(seq(1:40), m5data$X10, col=6, lw=2)
legend('right', inset=0.02, legend=c('M1', 'M2', 'M3', 'M4', 'M5'), pch =c(20), col=c(1,2,3,4,6), cex=0.8 )

par(mar=c(5,5,4,3))
plot(seq(1:40), f1data$X10, type='n', xlab="HZ location", ylab="% cline", main="Female genotype cline 1000 gen", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), f1data$X10, lw=2)
lines(seq(1:40), f2data$X10, col=2, lw=2)
lines(seq(1:40), f3data$X10, col=3, lw=2)
lines(seq(1:40), f4data$X10, col=4, lw=2)
lines(seq(1:40), f5data$X10, col=5, lw=2)
lines(seq(1:40), f6data$X10, col=6, lw=2)
legend('right', inset=0.02, legend=c('F1', 'F2', 'F3', 'F4', 'F5', 'F6'), pch =c(20), col=c(1,2,3,4,5,6), cex=0.8 )

par(mar=c(5,5,4,3))
plot(seq(1:40), m1data$X30, type='n', xlab="HZ location", ylab="% cline", main="Male genotype cline 3000 gen", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), m1data$X30, lw=2)
lines(seq(1:40), m2data$X30, col=2, lw=2)
lines(seq(1:40), m3data$X30, col=3, lw=2)
lines(seq(1:40), m4data$X30, col=4, lw=2)
lines(seq(1:40), m5data$X30, col=6, lw=2)

par(mar=c(5,5,4,3))
plot(seq(1:40), f1data$X30, type='n', xlab="HZ location", ylab="% cline", main="Female genotype cline 3000 gen", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), f1data$X30, lw=2)
lines(seq(1:40), f2data$X30, col=2, lw=2)
lines(seq(1:40), f3data$X30, col=3, lw=2)
lines(seq(1:40), f4data$X30, col=4, lw=2)
lines(seq(1:40), f5data$X30, col=5, lw=2)
lines(seq(1:40), f6data$X30, col=6, lw=2)

plot(0, type="n", axes=F, xlab="", ylab="", main="Sim parameters (Deterministic)")
addtable2plot(.6, -0.5, tabData, bty='o', hlines=F, vlines=F, display.rownames=F, display.colnames=F, yjust=1, xjust=0, cex=0.9)
dev.off()