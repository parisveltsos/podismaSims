library(plotrix)
datapath <- '~/git/podismaSims/output/SIMNAME'
fdata <- read.table(file.path(datapath, 'Rinput_Repl0TrObservedZone.txt'), header=T)
ydata <- read.table(file.path(datapath, 'Rinput_Repl0TrTotalY.txt'), header=T)
mtdata <- read.table(file.path(datapath, 'Rinput_Repl0TrmtDNA.txt'), header=T)
adata <- read.table(file.path(datapath, 'Rinput_Repl0TrAutosomalAllele.txt'), header=T)
ffitness <- read.table(file.path(datapath, 'Rinput_Repl0TrFemaleFitness.txt'), header=T)
mfitness <- read.table(file.path(datapath, 'Rinput_Repl0TrMaleFitness.txt'), header=T)
afitness <- read.table(file.path(datapath, 'Rinput_Repl0TrTotalFitness.txt'), header=T)
# shfemales <- read.table(file.path(datapath, 'Rinput_Repl0TrShoeFemales.txt'), header=T)
yfemales <- read.table(file.path(datapath, 'Rinput_Repl0TrOutputYinFemales.txt'), header=T)
ynfemales <- read.table(file.path(datapath, 'Rinput_Repl0TrNextToYinFemales.txt'), header=T)
# str(fdata)
tabData <- read.table(file.path(datapath, 'table.txt'))


pdf(file.path(datapath,'clinePlotStoc.pdf'), width=12, height=12)
par(mfrow=c(3,2)) 
par(mar=c(5,5,4,3))
plot(seq(1:40), fdata$X1, type='n', xlab="HZ location", ylab="% cline", main="Fusion cline", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), fdata$X1, lw=2)
lines(seq(1:40), fdata$X10, col=2, lw=2)
lines(seq(1:40), fdata$X20, col=3, lw=2)
lines(seq(1:40), fdata$X30, col=4, lw=2)
lines(seq(1:40), fdata$X40, col=6, lw=2)
lines(seq(1:40), fdata$X100, col=8, lw=2)
legend('bottomright', inset=0.02, legend=c('g1', 'g100', 'g200', 'g300', 'g400', 'g1000'), pch =c(20), col=c(1,2,3,4,6,8), cex=0.8 )

par(mar=c(5,5,4,3))
plot(c(1,40), c(0, max(ydata)/4), type='n', xlab="HZ location", ylab="% cline", main="Y cline", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), ydata$X1/4, lty=2, lw=2)
lines(seq(1:40), ydata$X10/4, col=2, lty=2, lw=2)
lines(seq(1:40), ydata$X20/4, col=3, lty=2, lw=2)
lines(seq(1:40), ydata$X30/4, col=4, lty=2, lw=2)
lines(seq(1:40), ydata$X40/4, col=6, lty=2, lw=2)
lines(seq(1:40), ydata$X100/4, col=8, lty=2, lw=2)

par(mar=c(5,5,4,3))
plot(seq(1:40), mtdata$X1/2, type='n', xlab="HZ location", ylab="% cline", main="mtDNA cline", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), mtdata$X1/2, lty=3, lw=2)
lines(seq(1:40), mtdata$X10/2, col=2, lty=3, lw=2)
lines(seq(1:40), mtdata$X20/2, col=3, lty=3, lw=2)
lines(seq(1:40), mtdata$X30/2, col=4, lty=3, lw=2)
lines(seq(1:40), mtdata$X40/2, col=6, lty=3, lw=2)
lines(seq(1:40), mtdata$X100/2, col=8, lty=3, lw=2)

par(mar=c(5,5,4,3))
plot(seq(1:40), adata$X1/4, type='n', xlab="HZ location", ylab="% cline", main="Au cline", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), adata$X1/4, lty=4, lw=2)
lines(seq(1:40), adata$X10/4, col=2, lty=4, lw=2)
lines(seq(1:40), adata$X20/4, col=3, lty=4, lw=2)
lines(seq(1:40), adata$X30/4, col=4, lty=4, lw=2)
lines(seq(1:40), adata$X40/4, col=6, lty=4, lw=2)
lines(seq(1:40), adata$X100/4, col=8, lty=4, lw=2)

plot(0, type="n", axes=F, xlab="", ylab="", main="Sim parameters (Stochastic)")
addtable2plot(.6, -0.5, tabData, bty='o', hlines=F, vlines=F, display.rownames=F, display.colnames=F, yjust=1, xjust=0, cex=0.9)
dev.off()

pdf(file.path(datapath,'fitnessPlotStoc.pdf'), width=12, height=12)
par(mfrow=c(3,2)) 
par(mar=c(5,5,4,3))
plot(c(0,40), c((min(ffitness, mfitness)-0.1)/100,1), type='n', xlab="HZ location", ylab="Female fitness", main="F fitness", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), ffitness$X1/100, lty=3, lw=2)
lines(seq(1:40), ffitness$X10/100, col=2, lty=3, lw=2)
lines(seq(1:40), ffitness$X20/100, col=3, lty=3, lw=2)
lines(seq(1:40), ffitness$X30/100, col=4, lty=3, lw=2)
lines(seq(1:40), ffitness$X40/100, col=6, lty=3, lw=2)
lines(seq(1:40), ffitness$X100/100, col=8, lty=3, lw=2)
legend('bottomright', inset=0.02, legend=c('g1', 'g100', 'g200', 'g300', 'g400', 'g1000'), pch =c(20), col=c(1,2,3,4,6,8), cex=0.8 )

par(mar=c(5,5,4,3))
plot(c(0,40), c((min(ffitness, mfitness)-0.1)/100,1), type='n', xlab="HZ location", ylab="Male fitness", main="M fitness", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), mfitness$X1/100, lty=1, lw=2)
lines(seq(1:40), mfitness$X10/100, col=2, lty=1, lw=2)
lines(seq(1:40), mfitness$X20/100, col=3, lty=1, lw=2)
lines(seq(1:40), mfitness$X30/100, col=4, lty=1, lw=2)
lines(seq(1:40), mfitness$X40/100, col=6, lty=1, lw=2)
lines(seq(1:40), mfitness$X100/100, col=8, lty=1, lw=2)

par(mar=c(5,5,4,3))
plot(c(0,40), c(0, max(yfemales)+1), type='n', xlab="HZ location", ylab="Number Y females", main="Y in females", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), yfemales$X1, lty=2, lw=2)
lines(seq(1:40), yfemales$X10, col=2, lty=2, lw=2)
lines(seq(1:40), yfemales$X20, col=3, lty=2, lw=2)
lines(seq(1:40), yfemales$X30, col=4, lty=2, lw=2)
lines(seq(1:40), yfemales$X40, col=6, lty=2, lw=2)
lines(seq(1:40), yfemales$X100, col=8, lty=2, lw=2)

par(mar=c(5,5,4,3))
plot(c(0,40), c((min(ffitness, mfitness)-1)/100,1), type='n', xlab="HZ location", ylab="Total fitness", main="All fitness", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), afitness$X1/100, lty=2, lw=2)
lines(seq(1:40), afitness$X10/100, col=2, lty=2, lw=2)
lines(seq(1:40), afitness$X20/100, col=3, lty=2, lw=2)
lines(seq(1:40), afitness$X30/100, col=4, lty=2, lw=2)
lines(seq(1:40), afitness$X40/100, col=6, lty=2, lw=2)
lines(seq(1:40), afitness$X100/100, col=8, lty=2, lw=2)

par(mar=c(5,5,4,3))
plot(c(0,40), c(0, max(ynfemales)+1), type='n', xlab="HZ location", ylab="Number Y neighbour females", main="Y rec locus in females", cex.main=1.8, cex.lab=1.3)
lines(seq(1:40), ynfemales$X1, lty=5, lw=2)
lines(seq(1:40), ynfemales$X10, col=2, lty=5, lw=2)
lines(seq(1:40), ynfemales$X20, col=3, lty=5, lw=2)
lines(seq(1:40), ynfemales$X30, col=4, lty=5, lw=2)
lines(seq(1:40), ynfemales$X40, col=6, lty=5, lw=2)
lines(seq(1:40), ynfemales$X100, col=8, lty=5, lw=2)

plot(0, type="n", axes=F, xlab="", ylab="", main="Sim parameters (Stochastic)")
addtable2plot(.6, -0.5, tabData, bty='o', hlines=F, vlines=F, display.rownames=F, display.colnames=F, yjust=1, xjust=0, cex=0.9)
dev.off()


